version: '3.3'
services:
  jupyter_notebook:
    restart: always
    networks:
      main:
          ipv4_address: 10.0.2.21
    image: 'jupyter-notebook:latest'
    build:
      context: '.'
      dockerfile: dockerfile
      cache_from:
        - 'jupyter-notebook:latest'
    volumes: 
      - type: volume
        source: jupyter_notebook
        target: /home/jupyter
    entrypoint: ['jupyter','notebook','--no-browser',"--ip='0.0.0.0'","--NotebookApp.password=$(echo $JUPYTERPASSWORD | python -c 'from notebook.auth import passwd;print(passwd(input()))')"]
networks:
  main:
    external:
      name : main-overlay
volumes:
  jupyter_notebook: